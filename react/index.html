<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/CSS/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha256-5eIC48iZUHmSlSUz9XtjRyK2mzQkHScZY1WdMaoz74E=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"yoursite.com","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.21.1","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="Reactreact包可以使用在app和web application里面的 基础篇–Hooks响应式钩子useStatereact中最常使用的钩子，用来存储状态做响应式的  用法import &#123; useState &#125; from &#x27;react&#x27;const [count, setCount] &#x3D; useState(0)setCount(1) &#x2F;&#x2F; count">
<meta property="og:type" content="website">
<meta property="og:title" content="react">
<meta property="og:url" content="http://yoursite.com/react/">
<meta property="og:site_name" content="zhuzhu&#39;s blog">
<meta property="og:description" content="Reactreact包可以使用在app和web application里面的 基础篇–Hooks响应式钩子useStatereact中最常使用的钩子，用来存储状态做响应式的  用法import &#123; useState &#125; from &#x27;react&#x27;const [count, setCount] &#x3D; useState(0)setCount(1) &#x2F;&#x2F; count">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2023-09-18T14:05:33.000Z">
<meta property="article:modified_time" content="2025-07-07T16:02:18.914Z">
<meta property="article:author" content="前端那只猪">
<meta property="article:tag" content="learning font-end react record">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://yoursite.com/react/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":false,"lang":"zh-CN","comments":true,"permalink":"http://yoursite.com/react/","path":"react/index.html","title":"react"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>react | zhuzhu's blog
</title>
  








  <noscript>
    <link rel="stylesheet" href="/CSS/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">zhuzhu's blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">知识总结与记录</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-html"><a href="/HTML/" rel="section"><i class="fa html fa-fw"></i>HTML</a></li><li class="menu-item menu-item-javascript"><a href="/javascript/" rel="section"><i class="fa javascript fa-fw"></i>JavaScript</a></li><li class="menu-item menu-item-css"><a href="/CSS/" rel="section"><i class="fa css3 fa-fw"></i>CSS</a></li><li class="menu-item menu-item-network"><a href="/network/" rel="section"><i class="fa http fa-fw"></i>network</a></li><li class="menu-item menu-item-brower"><a href="/brower/" rel="section"><i class="fa brower fa-fw"></i>brower</a></li><li class="menu-item menu-item-vue"><a href="/vue/" rel="section"><i class="fa vue fa-fw"></i>VUE</a></li><li class="menu-item menu-item-react"><a href="/react/" rel="section"><i class="fa react fa-fw"></i>React</a></li><li class="menu-item menu-item-nodejs"><a href="/node/" rel="section"><i class="fa nodejs fa-fw"></i>NodeJS</a></li><li class="menu-item menu-item-algorithm"><a href="/algorithm/" rel="section"><i class="fa fa-code fa-fw"></i>algorithm</a></li><li class="menu-item menu-item-engineer"><a href="/engineer/" rel="section"><i class="fa engine fa-fw"></i>engineer</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#React"><span class="nav-number">1.</span> <span class="nav-text">React</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E7%AF%87%E2%80%93Hooks"><span class="nav-number">1.1.</span> <span class="nav-text">基础篇–Hooks</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%93%8D%E5%BA%94%E5%BC%8F%E9%92%A9%E5%AD%90"><span class="nav-number">1.1.1.</span> <span class="nav-text">响应式钩子</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#useState"><span class="nav-number">1.1.1.1.</span> <span class="nav-text">useState</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#useReducer"><span class="nav-number">1.1.1.2.</span> <span class="nav-text">useReducer</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#useState-%E4%B8%8E-useReducer-%E6%AF%94%E8%BE%83"><span class="nav-number">1.1.1.2.1.</span> <span class="nav-text">useState 与 useReducer 比较</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#useContent"><span class="nav-number">1.1.1.3.</span> <span class="nav-text">useContent</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#useContent-%E5%B8%B8%E7%94%A8%E7%9A%84%E5%9C%BA%E6%99%AF"><span class="nav-number">1.1.1.3.1.</span> <span class="nav-text">useContent 常用的场景</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#useReducer-%E4%B8%8E-useContent-%E5%8D%8F%E5%90%8C"><span class="nav-number">1.1.1.3.2.</span> <span class="nav-text">useReducer 与 useContent 协同</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%89%AF%E4%BD%9C%E7%94%A8%E9%92%A9%E5%AD%90"><span class="nav-number">1.1.2.</span> <span class="nav-text">副作用钩子</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#useEffect"><span class="nav-number">1.1.2.1.</span> <span class="nav-text">useEffect</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#useLayoutEffect"><span class="nav-number">1.1.2.2.</span> <span class="nav-text">useLayoutEffect</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#useInsertionEffect"><span class="nav-number">1.1.2.3.</span> <span class="nav-text">useInsertionEffect</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BC%93%E5%AD%98%E9%92%A9%E5%AD%90"><span class="nav-number">1.1.3.</span> <span class="nav-text">缓存钩子</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#useCallback"><span class="nav-number">1.1.3.1.</span> <span class="nav-text">useCallback</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#useMemo"><span class="nav-number">1.1.3.2.</span> <span class="nav-text">useMemo</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9E%E4%BE%8B%E9%92%A9%E5%AD%90"><span class="nav-number">1.1.4.</span> <span class="nav-text">实例钩子</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#useRef"><span class="nav-number">1.1.4.1.</span> <span class="nav-text">useRef</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#useRef-%E4%B8%8E-%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-number">1.1.4.1.1.</span> <span class="nav-text">useRef 与 全局变量的区别</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#useImperativeHandle"><span class="nav-number">1.1.4.2.</span> <span class="nav-text">useImperativeHandle</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%B6%E4%BB%96"><span class="nav-number">1.1.5.</span> <span class="nav-text">其他</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#useTransition"><span class="nav-number">1.1.5.1.</span> <span class="nav-text">useTransition</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#useSyncExternalStore"><span class="nav-number">1.1.5.2.</span> <span class="nav-text">useSyncExternalStore</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#useDeferredValue"><span class="nav-number">1.1.5.3.</span> <span class="nav-text">useDeferredValue</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#useDebugValue"><span class="nav-number">1.1.5.4.</span> <span class="nav-text">useDebugValue</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#useId"><span class="nav-number">1.1.5.5.</span> <span class="nav-text">useId</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9E%E9%AA%8C%E6%80%A7%E9%92%A9%E5%AD%90"><span class="nav-number">1.1.6.</span> <span class="nav-text">实验性钩子</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#useOptimistic"><span class="nav-number">1.1.6.1.</span> <span class="nav-text">useOptimistic</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E7%AF%87%E2%80%93Component"><span class="nav-number">1.2.</span> <span class="nav-text">基础篇–Component</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Component"><span class="nav-number">1.2.0.1.</span> <span class="nav-text">Component</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#context"><span class="nav-number">1.2.0.2.</span> <span class="nav-text">context</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#props"><span class="nav-number">1.2.0.3.</span> <span class="nav-text">props</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ref"><span class="nav-number">1.2.0.4.</span> <span class="nav-text">ref</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#state"><span class="nav-number">1.2.0.5.</span> <span class="nav-text">state</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#constructor-props"><span class="nav-number">1.2.0.6.</span> <span class="nav-text">constructor(props)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#componentDiCatch-error-info"><span class="nav-number">1.2.0.7.</span> <span class="nav-text">componentDiCatch(error, info)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#componentDidMount"><span class="nav-number">1.2.0.8.</span> <span class="nav-text">componentDidMount()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#componentDidUpdate-prevProps-prevState-snapshot"><span class="nav-number">1.2.0.9.</span> <span class="nav-text">componentDidUpdate(prevProps, prevState, snapshot?)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#componentWillUnmount"><span class="nav-number">1.2.0.10.</span> <span class="nav-text">componentWillUnmount()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#forceUpdate-callback"><span class="nav-number">1.2.0.11.</span> <span class="nav-text">forceUpdate(callback?)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#getSnapshotBeforeUpdate-prevProps-prevState"><span class="nav-number">1.2.0.12.</span> <span class="nav-text">getSnapshotBeforeUpdate(prevProps, prevState)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#render"><span class="nav-number">1.2.0.13.</span> <span class="nav-text">render()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#getDerivedStateFromError"><span class="nav-number">1.2.0.14.</span> <span class="nav-text">getDerivedStateFromError</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#React-Dom"><span class="nav-number">2.</span> <span class="nav-text">React Dom</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Hooks"><span class="nav-number">2.1.</span> <span class="nav-text">Hooks</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#useFormStatus"><span class="nav-number">2.1.0.1.</span> <span class="nav-text">useFormStatus</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#APIs"><span class="nav-number">2.2.</span> <span class="nav-text">APIs</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#createPortal"><span class="nav-number">2.2.0.1.</span> <span class="nav-text">createPortal</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#flushSync"><span class="nav-number">2.2.0.2.</span> <span class="nav-text">flushSync</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#createRoot"><span class="nav-number">2.2.0.3.</span> <span class="nav-text">createRoot</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#hydrateRoot"><span class="nav-number">2.2.0.4.</span> <span class="nav-text">hydrateRoot</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#findDOMNode-Deprecated"><span class="nav-number">2.2.0.5.</span> <span class="nav-text">findDOMNode(Deprecated)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#render-Deprecated"><span class="nav-number">2.2.0.6.</span> <span class="nav-text">render(Deprecated)</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Server-APIs"><span class="nav-number">2.2.1.</span> <span class="nav-text">Server APIs</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#renderPipableStream"><span class="nav-number">2.2.1.1.</span> <span class="nav-text">renderPipableStream</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#renderToReadableStream"><span class="nav-number">2.2.1.2.</span> <span class="nav-text">renderToReadableStream</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#renderToStaticMarkup"><span class="nav-number">2.2.1.3.</span> <span class="nav-text">renderToStaticMarkup</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#renderToStaticNodeStream"><span class="nav-number">2.2.1.4.</span> <span class="nav-text">renderToStaticNodeStream</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#renderToString"><span class="nav-number">2.2.1.5.</span> <span class="nav-text">renderToString</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%81%97%E7%95%99APIs"><span class="nav-number">3.</span> <span class="nav-text">遗留APIs</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Component-1"><span class="nav-number">3.0.1.</span> <span class="nav-text">Component</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">前端那只猪</p>
  <div class="site-description" itemprop="description">学习前端过程中的知识点跟汇总</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">3</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="cc-license animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner page posts-expand">


    
    
    
    <div class="post-block" lang="zh-CN"><header class="post-header">

<h1 class="post-title" itemprop="name headline">react
</h1>

<div class="post-meta-container">
</div>

</header>

      
      
      
      <div class="post-body">
          <h2 id="React"><a href="#React" class="headerlink" title="React"></a>React</h2><p><code>react</code>包可以使用在<code>app</code>和<code>web application</code>里面的</p>
<h3 id="基础篇–Hooks"><a href="#基础篇–Hooks" class="headerlink" title="基础篇–Hooks"></a>基础篇–Hooks</h3><h4 id="响应式钩子"><a href="#响应式钩子" class="headerlink" title="响应式钩子"></a>响应式钩子</h4><h5 id="useState"><a href="#useState" class="headerlink" title="useState"></a>useState</h5><p>react中最常使用的钩子，用来存储状态做响应式的</p>
<ul>
<li>用法<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">const</span> [count, setCount] = <span class="title function_">useState</span>(<span class="number">0</span>)</span><br><span class="line"><span class="title function_">setCount</span>(<span class="number">1</span>) <span class="comment">// count will change</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="useReducer"><a href="#useReducer" class="headerlink" title="useReducer"></a>useReducer</h5><p>作用同useState，两者的作用是一样的；但是useReducer需要是一个没有副作用的纯函数</p>
<ul>
<li>用法<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useReducer &#125; <span class="keyword">from</span> <span class="string">&#x27;React&#x27;</span></span><br><span class="line"><span class="keyword">const</span> [tasks, dispatchTask] = <span class="title function_">useReducer</span>(taskReducer, initialTasks)</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">taskReducer</span>(<span class="params">tasks, action</span>) &#123;</span><br><span class="line">  <span class="comment">// ...do something</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">dispatchTask</span>(action) <span class="comment">// throught dispatch trigger</span></span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">副作用函数：会对指定内容以外的元素产生影响 -- 发起请求、操作dom元素等</span><br></pre></td></tr></table></figure></li>
</ul>
<h6 id="useState-与-useReducer-比较"><a href="#useState-与-useReducer-比较" class="headerlink" title="useState 与 useReducer 比较"></a>useState 与 useReducer 比较</h6><ul>
<li><code>编程上</code>: 虽然<code>useState</code>的代码比较少，但是<code>useReducer</code>更方便将重复的操作通过相同的事件控制</li>
<li><code>可读性</code>: 当state简单的时候<code>useState</code>的可读性更高，当需要管理的state比较复杂的时候<code>useReducer</code>的可读性反而更高</li>
<li><code>调试上</code>: 使用<code>useState</code>来管理state时，很难找到报错的位置在哪里；但是<code>useReducer</code>可以在reduce内通过log调试代码，甚至可以在action中查看触发的条件</li>
<li><code>测试上</code>: 由于<code>useReducer</code>是纯函数，并不依赖组件；所以可以将reduce导出进行测试<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">useState 和 useReducer 的返回结果是一样的，所以使用useState 和 useReducer 更多是看个人编码习惯</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="useContent"><a href="#useContent" class="headerlink" title="useContent"></a>useContent</h5><p>通过<code>useContent</code>向深层子组件穿透state，而不是通过props；同时可以在多个组件中共享state；比props方便</p>
<ul>
<li>用法<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// define myContent.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; createContent &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> myContent = <span class="title function_">createContent</span>(<span class="number">0</span>)</span><br><span class="line"><span class="comment">// using usingContent.js</span></span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">MyContent</span>&#125; <span class="keyword">from</span> <span class="string">&#x27;myContent.js&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; useContent &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">usingContent</span>(<span class="params">&#123;children&#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> counter = <span class="title function_">useContent</span>(<span class="title class_">MyContent</span>)</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">MyContent.Provider</span> <span class="attr">value</span>=<span class="string">&#123;counter</span> + <span class="attr">1</span>&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;children&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">MyContent.Provider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h6 id="useContent-常用的场景"><a href="#useContent-常用的场景" class="headerlink" title="useContent 常用的场景"></a>useContent 常用的场景</h6><ul>
<li><code>主题</code>: 可以用来存放主题信息，更改app的主题</li>
<li><code>账号信息</code>: 在app中会有许多地方用到账号信息，可以通过useContent来进行账号信息的共享</li>
<li><code>路由</code>: 很多路由的实现都是通过useContent，可以共享当前活动的路由信息</li>
<li><code>状态管理</code>: 可以通过useContent来实现app内的状态管理</li>
</ul>
<h6 id="useReducer-与-useContent-协同"><a href="#useReducer-与-useContent-协同" class="headerlink" title="useReducer 与 useContent 协同"></a>useReducer 与 useContent 协同</h6><p>通过<code>useContext</code>管理<code>useReducer</code>，可以实现深层或者不同组件的状态管理</p>
<ul>
<li>用法<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// reducerContext.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; createContext &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title class_">MyReducer</span> = <span class="title function_">createContext</span>(<span class="literal">null</span>)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title class_">MyReducerDispatch</span> = <span class="title function_">createContext</span>(<span class="literal">null</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// root.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; useReducer &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">MyReducer</span>, <span class="title class_">MyReducerDispatch</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./reducerContext.js&#x27;</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">myReducerFn</span>(<span class="params">myReducer, action</span>) &#123;</span><br><span class="line">  <span class="comment">// ...do something</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> intialReducer = &#123;</span><br><span class="line">  <span class="comment">// ...prototype</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">Root</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [myReducer, myReducerDispatch] = <span class="title function_">useReducer</span>(myReducerFn, intialReducer)</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">myReducer.Provider</span> <span class="attr">value</span>=<span class="string">&quot;&#123;myReducer&#125;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">myReducerDispatch.Provider</span> <span class="attr">value</span>=<span class="string">&quot;&#123;myReducerDispatch&#125;&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">myReducerDispatch.Provider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">myReducer.Provider</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// child.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; useContext &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">MyReducer</span>, <span class="title class_">MyReducerDispatch</span> &#125; <span class="keyword">from</span> <span class="string">&#x27;./reducerContext.js&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">Child</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> myReducer = <span class="title function_">useContext</span>(<span class="title class_">MyReducer</span>)</span><br><span class="line">  <span class="keyword">const</span> myReducerDispatch = <span class="title function_">useContext</span>(<span class="title class_">MyReducerDispatch</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&quot;&#123;myReducerDispatch(&#123;...args&#125;)&#125;&quot;</span>&gt;</span>&#123;myReducer.label&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="副作用钩子"><a href="#副作用钩子" class="headerlink" title="副作用钩子"></a>副作用钩子</h4><h5 id="useEffect"><a href="#useEffect" class="headerlink" title="useEffect"></a>useEffect</h5><p>副作用钩子<code>useEffect</code>可以在<code>reactive</code>(eg: props、state)变量改变的时候执行函数，<code>useEffect</code>包含了三个生命周期：<code>mount</code>、<code>update</code>、<code>unmount</code></p>
<ul>
<li>用法<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// useEffect(setup, dependecies?)</span></span><br><span class="line"><span class="keyword">import</span> &#123; useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">myComponent</span>(<span class="params">&#123; myPorop &#125;</span>) &#123;</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123; <span class="comment">// mount &amp; update lifecycle</span></span><br><span class="line">    <span class="comment">// ...do something</span></span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123; <span class="comment">// unmount</span></span><br><span class="line">      <span class="comment">// ...do something</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, [myProp] <span class="comment">// dependencies</span></span><br><span class="line">)&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="useLayoutEffect"><a href="#useLayoutEffect" class="headerlink" title="useLayoutEffect"></a>useLayoutEffect</h5><p><code>useLayoutEffect</code>是<code>useEffect</code>的一个小版本，会在浏览器重绘前触发；作用：可以在浏览器重绘前获取到将要重绘的<code>DOM</code>信息（ps：也可以获取到变化前的<code>DOM</code>信息）</p>
<ul>
<li>用法<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 语法与useEffect一样：useLayoutEffect(setup, dependencies?)</span></span><br><span class="line"><span class="keyword">import</span> &#123; useState, useRef, useLayoutEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Tooltip</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> ref = <span class="title function_">useRef</span>(<span class="literal">null</span>);</span><br><span class="line">  <span class="keyword">const</span> [tooltipHeight, setTooltipHeight] = <span class="title function_">useState</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useLayoutEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; height &#125; = ref.<span class="property">current</span>.<span class="title function_">getBoundingClientRect</span>();</span><br><span class="line">    <span class="title function_">setTooltipHeight</span>(height);</span><br><span class="line">  &#125;, []);</span><br><span class="line">  <span class="comment">// ...</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="useInsertionEffect"><a href="#useInsertionEffect" class="headerlink" title="useInsertionEffect"></a>useInsertionEffect</h5><p><code>useInsertionEffect</code>允许在<code>Layout Effect</code>触发前向<code>DOM</code>插入元素；可以用于style注入上（css-in-js）</p>
<ul>
<li>用法<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 语法与useEffect一样：useLayoutEffect(setup, dependencies?)</span></span><br><span class="line"><span class="comment">// Inside your CSS-in-JS library</span></span><br><span class="line"><span class="keyword">let</span> isInserted = <span class="keyword">new</span> <span class="title class_">Set</span>();</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">useCSS</span>(<span class="params">rule</span>) &#123;</span><br><span class="line">  <span class="title function_">useInsertionEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// As explained earlier, we don&#x27;t recommend runtime injection of &lt;style&gt; tags.</span></span><br><span class="line">    <span class="comment">// But if you have to do it, then it&#x27;s important to do in useInsertionEffect.</span></span><br><span class="line">    <span class="keyword">if</span> (!isInserted.<span class="title function_">has</span>(rule)) &#123;</span><br><span class="line">      isInserted.<span class="title function_">add</span>(rule);</span><br><span class="line">      <span class="variable language_">document</span>.<span class="property">head</span>.<span class="title function_">appendChild</span>(<span class="title function_">getStyleForRule</span>(rule));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> rule;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Button</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> className = <span class="title function_">useCSS</span>(<span class="string">&#x27;...&#x27;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#123;className&#125;</span> /&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="缓存钩子"><a href="#缓存钩子" class="headerlink" title="缓存钩子"></a>缓存钩子</h4><h5 id="useCallback"><a href="#useCallback" class="headerlink" title="useCallback"></a>useCallback</h5><p><code>useCallback</code>用于缓存一个函数（ps：只是返回的函数地址没有变化，并不是函数不会重新创建）</p>
<ul>
<li>用法<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 语法：useCallback(fn, dependencies)</span></span><br><span class="line"><span class="keyword">import</span> &#123; useCallback &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">ProductPage</span>(<span class="params">&#123; productId, referrer, theme &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> handleSubmit = <span class="title function_">useCallback</span>(<span class="function">(<span class="params">orderDetails</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">post</span>(<span class="string">&#x27;/product/&#x27;</span> + productId + <span class="string">&#x27;/buy&#x27;</span>, &#123;</span><br><span class="line">      referrer,</span><br><span class="line">      orderDetails,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;, [productId, referrer]);</span><br><span class="line">   <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#123;theme&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">ShippingForm</span> <span class="attr">onSubmit</span>=<span class="string">&#123;handleSubmit&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// shippingForm.jsx</span></span><br><span class="line"><span class="keyword">import</span> &#123; memo &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">ShippingForm</span> = <span class="title function_">memo</span>(<span class="keyword">function</span> <span class="title function_">ShippingForm</span>(<span class="params">&#123; onSubmit &#125;</span>) &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">如上看到的，useCallback主要用于针对memo缓存起来的组件；当handleSubmit是一个普通函数时，如果父组件发生变化的时候，函数也会重新被创建；同时shippingForm组件也会触发更新，memo就不起作用了</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="useMemo"><a href="#useMemo" class="headerlink" title="useMemo"></a>useMemo</h5><p><code>useMemo</code>作用类似<code>useCallback</code>，不同的是<code>useMemo</code>缓存的是一个值</p>
<ul>
<li><p>使用场景</p>
<ul>
<li>用于对复杂耗时的计算进行缓存，避免耗时大的计算重复触发</li>
<li>对props的值进行缓存，避免在子组件在memo的情况下重新渲染</li>
</ul>
</li>
<li><p>语法</p>
<p><code>useMemo(calculateValue, dependencies)</code></p>
</li>
<li><p>用法</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useMemo &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">TodoList</span>(<span class="params">&#123; todos, tab &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> visibleTodos = <span class="title function_">useMemo</span>(</span><br><span class="line">    <span class="function">() =&gt;</span> <span class="title function_">filterTodos</span>(todos, tab),</span><br><span class="line">    [todos, tab]</span><br><span class="line">  );</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="实例钩子"><a href="#实例钩子" class="headerlink" title="实例钩子"></a>实例钩子</h4><h5 id="useRef"><a href="#useRef" class="headerlink" title="useRef"></a>useRef</h5><p><code>useRef</code>和<code>useState</code>都是获取组件更新(渲染)前的值，<code>useRef</code>更新不会导致组件重新渲染，<code>useState</code>会导致组件重新渲染；<code>useRef</code>是一个对象且只有一个属性<code>current</code>，可以通过<code>current</code>修改值；<code>useRef</code>通常被用来保存一些不变的信息，比如：<code>DOM</code>、<code>定时器</code></p>
<ul>
<li>用法<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useRef &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">Form</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> inputRef = <span class="title function_">useRef</span>(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">handleClick</span>(<span class="params"></span>) &#123;</span><br><span class="line">    inputRef.<span class="property">current</span>.<span class="title function_">focus</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">ref</span>=<span class="string">&#123;inputRef&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;handleClick&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        Focus the input</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h6 id="useRef-与-全局变量的区别"><a href="#useRef-与-全局变量的区别" class="headerlink" title="useRef 与 全局变量的区别"></a>useRef 与 全局变量的区别</h6><p>我们会思考<code>useRef</code>既然不触发组件的重新渲染那跟使用全局变量有什么区别呢？所以我们要搞清楚<code>useRef</code>是指向当前组件实例的值(<code>A ref like a secret pocket of your component that React don&#39;t track</code>)，并不会受其他组件的影响，<code>全局变量</code>是指向全局的；所以当有多个相同组件的时候我们会发现<code>全局变量</code>并不会与我们预期的一样；所以在某些场景下(无相同组件&#x2F;不共用全局变量)<code>useRef</code>与<code>全局变量</code>的结果是一样的</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">后期思考：useRef、createRef、forwardRef这三者的区别</span><br></pre></td></tr></table></figure>

<h5 id="useImperativeHandle"><a href="#useImperativeHandle" class="headerlink" title="useImperativeHandle"></a>useImperativeHandle</h5><p><code>useImperativeHandle</code>可以向父组件暴露一个自定义方法或者子组件实例方法的实例，用于父组件调用子组件的方法</p>
<ul>
<li>语法<br><code>useImperativeHandle(ref, crateHandle, dependencies?)</code></li>
<li>用法<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ------- 当你想暴露子组件实例的时候</span></span><br><span class="line"><span class="keyword">import</span> &#123; forwardRef &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">MyInput</span> = <span class="title function_">forwardRef</span>(<span class="keyword">function</span> <span class="title function_">MyInput</span>(<span class="params">props, ref</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">input</span> &#123;<span class="attr">...props</span>&#125; <span class="attr">ref</span>=<span class="string">&#123;ref&#125;</span> /&gt;</span></span>;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ------- 当你使用useImperativeHandle暴露组件的实例方法</span></span><br><span class="line"><span class="keyword">import</span> &#123; forwardRef, useImperativeHandle &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">MyInput</span> = <span class="title function_">forwardRef</span>(<span class="keyword">function</span> <span class="title function_">MyInput</span>(<span class="params">props, ref</span>) &#123;</span><br><span class="line">  <span class="title function_">useImperativeHandle</span>(ref, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="title function_">focus</span>(<span class="params"></span>) &#123;</span><br><span class="line">        inputRef.<span class="property">current</span>.<span class="title function_">focus</span>();</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="title function_">scrollIntoView</span>(<span class="params"></span>) &#123;</span><br><span class="line">        inputRef.<span class="property">current</span>.<span class="title function_">scrollIntoView</span>();</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;, []);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">input</span> &#123;<span class="attr">...props</span>&#125; /&gt;</span></span>;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
<li>提问<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">问：可以使用useImperativeHandle暴露子组件的实例吗？</span><br><span class="line">答：可以的，useImperativeHandle是可以返回任意类型的值的，可以将子组件实例放到返回对象里面一起放回</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h4><h5 id="useTransition"><a href="#useTransition" class="headerlink" title="useTransition"></a>useTransition</h5><p><code>useTransition</code>可以让状态改变不阻塞UI，实现状态改变UI的丝滑过度</p>
<ul>
<li>语法<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const [isPending, startTransition] = useTransition()</span><br></pre></td></tr></table></figure></li>
<li>使用场景<ul>
<li>使状态变化不阻塞页面过渡</li>
<li>更新父组件的丝滑过度</li>
<li>获取状态变化的进程</li>
<li>实现状态过度时的loading效果</li>
</ul>
</li>
<li>用法<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// root.jsx</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Suspense</span>, useState &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">TabButton</span> <span class="keyword">from</span> <span class="string">&#x27;./TabButton.js&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">AboutTab</span> <span class="keyword">from</span> <span class="string">&#x27;./AboutTab.js&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">PostsTab</span> <span class="keyword">from</span> <span class="string">&#x27;./PostsTab.js&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ContactTab</span> <span class="keyword">from</span> <span class="string">&#x27;./ContactTab.js&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">TabContainer</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [tab, setTab] = <span class="title function_">useState</span>(<span class="string">&#x27;about&#x27;</span>);</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Suspense</span> <span class="attr">fallback</span>=<span class="string">&#123;</span>&lt;<span class="attr">h1</span>&gt;</span>🌀 Loading...<span class="tag">&lt;/<span class="name">h1</span>&gt;</span>&#125;&gt;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">TabButton</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">isActive</span>=<span class="string">&#123;tab</span> === <span class="string">&#x27;about&#x27;</span>&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> setTab(&#x27;about&#x27;)&#125;</span></span><br><span class="line"><span class="language-xml">      &gt;</span></span><br><span class="line"><span class="language-xml">        About</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">TabButton</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">TabButton</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">isActive</span>=<span class="string">&#123;tab</span> === <span class="string">&#x27;posts&#x27;</span>&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> setTab(&#x27;posts&#x27;)&#125;</span></span><br><span class="line"><span class="language-xml">      &gt;</span></span><br><span class="line"><span class="language-xml">        Posts</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">TabButton</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">TabButton</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">isActive</span>=<span class="string">&#123;tab</span> === <span class="string">&#x27;contact&#x27;</span>&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> setTab(&#x27;contact&#x27;)&#125;</span></span><br><span class="line"><span class="language-xml">      &gt;</span></span><br><span class="line"><span class="language-xml">        Contact</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">TabButton</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;tab === &#x27;about&#x27; &amp;&amp; <span class="tag">&lt;<span class="name">AboutTab</span> /&gt;</span>&#125;</span></span><br><span class="line"><span class="language-xml">      &#123;tab === &#x27;posts&#x27; &amp;&amp; <span class="tag">&lt;<span class="name">PostsTab</span> /&gt;</span>&#125;</span></span><br><span class="line"><span class="language-xml">      &#123;tab === &#x27;contact&#x27; &amp;&amp; <span class="tag">&lt;<span class="name">ContactTab</span> /&gt;</span>&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Suspense</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="useSyncExternalStore"><a href="#useSyncExternalStore" class="headerlink" title="useSyncExternalStore"></a>useSyncExternalStore</h5><p>通过订阅的方式获取外部存储的数据</p>
<ul>
<li>语法</li>
</ul>
<p><code>useSyncExternalStore(subcribe, getSnapshot, getServerSnapshot?)</code></p>
<ul>
<li>参数说明<ul>
<li><code>subcribe</code>：<code>function</code>类型，定义了外部存储的订阅方法并且需要返回一个取消订阅的方法</li>
<li><code>getSnapshot</code>: <code>function</code>类型，返回外部存储的快照数据，重复调用该方法必须放回一样的值，如果返回的值不一样则会触发组件重新渲染</li>
<li><code>getServerSnapshot</code>: <code>function</code>类型，返回初始的快照的外部数据；通常被用在服务端渲染的时候，如果在服务端渲染的时候忽略它，将会抛出错误</li>
</ul>
</li>
<li>用法<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// --------------app.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; useSyncExternalStore &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; todosStore &#125; <span class="keyword">from</span> <span class="string">&#x27;./todoStore.js&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">TodosApp</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> todos = <span class="title function_">useSyncExternalStore</span>(todosStore.<span class="property">subscribe</span>, todosStore.<span class="property">getSnapshot</span>);</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> todosStore.addTodo()&#125;&gt;Add todo<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;todos.map(todo =&gt; (</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&#123;todo.id&#125;</span>&gt;</span>&#123;todo.text&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        ))&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ------------------external store</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// This is an example of a third-party store</span></span><br><span class="line"><span class="comment">// that you might need to integrate with React.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// If your app is fully built with React,</span></span><br><span class="line"><span class="comment">// we recommend using React state instead.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> nextId = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">let</span> todos = [&#123; <span class="attr">id</span>: nextId++, <span class="attr">text</span>: <span class="string">&#x27;Todo #1&#x27;</span> &#125;];</span><br><span class="line"><span class="keyword">let</span> listeners = [];</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> todosStore = &#123;</span><br><span class="line">  <span class="title function_">addTodo</span>(<span class="params"></span>) &#123;</span><br><span class="line">    todos = [...todos, &#123; <span class="attr">id</span>: nextId++, <span class="attr">text</span>: <span class="string">&#x27;Todo #&#x27;</span> + nextId &#125;]</span><br><span class="line">    <span class="title function_">emitChange</span>();</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">subscribe</span>(<span class="params">listener</span>) &#123;</span><br><span class="line">    listeners = [...listeners, listener];</span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      listeners = listeners.<span class="title function_">filter</span>(<span class="function"><span class="params">l</span> =&gt;</span> l !== listener);</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">getSnapshot</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> todos;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">emitChange</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> listener <span class="keyword">of</span> listeners) &#123;</span><br><span class="line">    <span class="title function_">listener</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="useDeferredValue"><a href="#useDeferredValue" class="headerlink" title="useDeferredValue"></a>useDeferredValue</h5><p><code>useDeferredValue</code>可以使部分UI延迟渲染</p>
<ul>
<li>语法</li>
</ul>
<p><code>useDeferredValue(value, initialValue?)</code></p>
<ul>
<li><p>参数说明</p>
<ul>
<li><code>value</code>：想要触发延迟的值，可以是任何类型</li>
<li><code>initialValue</code>: 最新版本的参数，初始化的值；如果忽略该值，在初始渲染的时候将不会延迟</li>
<li><code>返回值</code>：返回当前的值；在初始渲染的时候会返回提供的初始值；在提供值更新的时候会返回之前的值；当在后台延迟更新的时候会返回最新的值</li>
</ul>
</li>
<li><p>用法</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Suspense</span>, useState, useDeferredValue &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">SearchResults</span> <span class="keyword">from</span> <span class="string">&#x27;./SearchResults.js&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [query, setQuery] = <span class="title function_">useState</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">  <span class="keyword">const</span> deferredQuery = <span class="title function_">useDeferredValue</span>(query);</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        Search albums:</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">value</span>=<span class="string">&#123;query&#125;</span> <span class="attr">onChange</span>=<span class="string">&#123;e</span> =&gt;</span> setQuery(e.target.value)&#125; /&gt;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Suspense</span> <span class="attr">fallback</span>=<span class="string">&#123;</span>&lt;<span class="attr">h2</span>&gt;</span>Loading...<span class="tag">&lt;/<span class="name">h2</span>&gt;</span>&#125;&gt;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">SearchResults</span> <span class="attr">query</span>=<span class="string">&#123;deferredQuery&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Suspense</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="useDebugValue"><a href="#useDebugValue" class="headerlink" title="useDebugValue"></a>useDebugValue</h5><p><code>useDebugValue</code>用于给自定义钩子创建标签</p>
<ul>
<li>语法</li>
</ul>
<p><code>useDebugValue(value, format?)</code></p>
<ul>
<li>参数说明<ul>
<li><code>value</code>：任意类型，想要显示的内容</li>
<li><code>format</code>：格式化函数</li>
</ul>
</li>
<li>用法<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useSyncExternalStore, useDebugValue &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">useOnlineStatus</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> isOnline = <span class="title function_">useSyncExternalStore</span>(subscribe, <span class="function">() =&gt;</span> navigator.<span class="property">onLine</span>, <span class="function">() =&gt;</span> <span class="literal">true</span>);</span><br><span class="line">  <span class="title function_">useDebugValue</span>(isOnline ? <span class="string">&#x27;Online&#x27;</span> : <span class="string">&#x27;Offline&#x27;</span>);</span><br><span class="line">  <span class="keyword">return</span> isOnline;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">subscribe</span>(<span class="params">callback</span>) &#123;</span><br><span class="line">  <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;online&#x27;</span>, callback);</span><br><span class="line">  <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;offline&#x27;</span>, callback);</span><br><span class="line">  <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;online&#x27;</span>, callback);</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;offline&#x27;</span>, callback);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="useId"><a href="#useId" class="headerlink" title="useId"></a>useId</h5><p><code>useId</code>用以创建唯一的ID</p>
<h4 id="实验性钩子"><a href="#实验性钩子" class="headerlink" title="实验性钩子"></a>实验性钩子</h4><h5 id="useOptimistic"><a href="#useOptimistic" class="headerlink" title="useOptimistic"></a>useOptimistic</h5><p><code>useOptimistic</code>实现动态更新UI（异步更新state）</p>
<ul>
<li><p>语法</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> [optimisticState, addOptimistic] = <span class="title function_">useOptimistic</span>(state, updateFn);</span><br></pre></td></tr></table></figure></li>
<li><p>参数说明</p>
<ul>
<li><code>state</code>：初始的值和操作结束后的值</li>
<li><code>updateFn(currentState, optimisticValue)</code>：一个通过<code>addOptmistic</code>调用<code>currentState</code>和<code>optimisticValue</code>并且返回一个动态值的函数；函数的返回值会是<code>currentState</code>和<code>optimisticValue</code>的合并值</li>
</ul>
</li>
<li><p>返回值</p>
<ul>
<li><code>optimisticState</code>：动态状态的值；在没有操作的时候等于<code>state</code>，在pending的时候是<code>updateFn</code>的返回值</li>
<li><code>addOptimistic</code>: 在动态更新的时候的调度函数，该函数接收一个参数（<code>optimisticValue</code>）;在调用该函数是时候会触发<code>updateFn</code></li>
</ul>
</li>
<li><p>用法</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useOptimistic, useState, useRef &#125; <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; deliverMessage &#125; <span class="keyword">from</span> <span class="string">&quot;./actions.js&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Thread</span>(<span class="params">&#123; messages, sendMessage &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> formRef = <span class="title function_">useRef</span>();</span><br><span class="line">  <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">formAction</span>(<span class="params">formData</span>) &#123;</span><br><span class="line">    <span class="title function_">addOptimisticMessage</span>(formData.<span class="title function_">get</span>(<span class="string">&quot;message&quot;</span>));</span><br><span class="line">    formRef.<span class="property">current</span>.<span class="title function_">reset</span>();</span><br><span class="line">    <span class="keyword">await</span> <span class="title function_">sendMessage</span>(formData);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">const</span> [optimisticMessages, addOptimisticMessage] = <span class="title function_">useOptimistic</span>(</span><br><span class="line">    messages,</span><br><span class="line">    <span class="function">(<span class="params">state, newMessage</span>) =&gt;</span> [</span><br><span class="line">      ...state,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">text</span>: newMessage,</span><br><span class="line">        <span class="attr">sending</span>: <span class="literal">true</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;optimisticMessages.map((message, index) =&gt; (</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">key</span>=<span class="string">&#123;index&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;message.text&#125;</span></span><br><span class="line"><span class="language-xml">          &#123;!!message.sending &amp;&amp; <span class="tag">&lt;<span class="name">small</span>&gt;</span> (Sending...)<span class="tag">&lt;/<span class="name">small</span>&gt;</span>&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      ))&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&#123;formAction&#125;</span> <span class="attr">ref</span>=<span class="string">&#123;formRef&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;message&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;Hello!&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span>Send<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [messages, setMessages] = <span class="title function_">useState</span>([</span><br><span class="line">    &#123; <span class="attr">text</span>: <span class="string">&quot;Hello there!&quot;</span>, <span class="attr">sending</span>: <span class="literal">false</span>, <span class="attr">key</span>: <span class="number">1</span> &#125;</span><br><span class="line">  ]);</span><br><span class="line">  <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">sendMessage</span>(<span class="params">formData</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> sentMessage = <span class="keyword">await</span> <span class="title function_">deliverMessage</span>(formData.<span class="title function_">get</span>(<span class="string">&quot;message&quot;</span>));</span><br><span class="line">    <span class="title function_">setMessages</span>(<span class="function">(<span class="params">messages</span>) =&gt;</span> [...messages, &#123; <span class="attr">text</span>: sentMessage &#125;]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">Thread</span> <span class="attr">messages</span>=<span class="string">&#123;messages&#125;</span> <span class="attr">sendMessage</span>=<span class="string">&#123;sendMessage&#125;</span> /&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="基础篇–Component"><a href="#基础篇–Component" class="headerlink" title="基础篇–Component"></a>基础篇–Component</h3><p>注：react 不再推荐使用Component方式</p>
<ul>
<li>语法<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Greeting</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, &#123;this.props.name&#125;!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>参考</li>
</ul>
<h5 id="Component"><a href="#Component" class="headerlink" title="Component"></a>Component</h5><p>将React Component定义成一个class，继承<code>Component</code>类并且定义render方法</p>
<ul>
<li>用法<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Greeting</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, &#123;this.props.name&#125;!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="context"><a href="#context" class="headerlink" title="context"></a>context</h5><p><code>context</code>可以在component类中通过<code>this.context</code>使用；只有在使用<code>static contextType</code>或者<code>static contextTypes</code>（已废弃）定义想要接收的内容时才能被使用。一个Component类只能定义一个context</p>
<ul>
<li>用法<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Button</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="keyword">static</span> contextType = <span class="title class_">ThemeContext</span>;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> theme = <span class="variable language_">this</span>.<span class="property">context</span>;</span><br><span class="line">    <span class="keyword">const</span> className = <span class="string">&#x27;button-&#x27;</span> + theme;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">className</span>=<span class="string">&#123;className&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;this.props.children&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="props"><a href="#props" class="headerlink" title="props"></a>props</h5><p>props在component类中通过<code>this.props</code>使用</p>
<ul>
<li>用法<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Greeting</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, &#123;this.props.name&#125;!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;<span class="title class_">Greeting</span> name=<span class="string">&quot;Taylor&quot;</span> /&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="ref"><a href="#ref" class="headerlink" title="ref"></a>ref</h5><p>这个api在最新的主要版本中将会被废弃，但是可以使用<code>createRef</code>替代</p>
<ul>
<li>用法<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyComponent</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">myRefs</span> = <span class="title class_">React</span>.<span class="title function_">createRef</span>()</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">ref</span>=<span class="string">&#123;this.myRefs&#125;</span> /&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="state"><a href="#state" class="headerlink" title="state"></a>state</h5><p>在component类中使用state像<code>this.state</code>，<code>state</code>必须要是一个对象。不要直接更改state，可以使用<code>setState</code>更改state</p>
<ul>
<li>用法<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Counter</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">age</span>: <span class="number">42</span>,</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  handleAgeChange = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">      <span class="attr">age</span>: <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">age</span> + <span class="number">1</span> </span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.handleAgeChange&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        Increment age</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>You are &#123;this.state.age&#125;.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="constructor-props"><a href="#constructor-props" class="headerlink" title="constructor(props)"></a>constructor(props)</h5><p>constructor会在mount前运行。事实上，constructor只有用在两种情况，描述state和将类方法绑定到类实例中</p>
<ul>
<li>用法<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Counter</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123; <span class="attr">counter</span>: <span class="number">0</span> &#125;;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">handleClick</span> = <span class="variable language_">this</span>.<span class="property">handleClick</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">handleClick</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
如果使用现在的javascript语法的时候，constructor很少被需要；可以使用通用class语法去重写，在现在浏览器和工具（如：Babel）中都支持<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Counter</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  state = &#123; <span class="attr">counter</span>: <span class="number">0</span> &#125;;</span><br><span class="line"></span><br><span class="line">  handleClick = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="componentDiCatch-error-info"><a href="#componentDiCatch-error-info" class="headerlink" title="componentDiCatch(error, info)"></a>componentDiCatch(error, info)</h5><p>React会在子组件渲染中抛出错误的时候调用；该函数通常会根<a href="#getderivedstatefromerror">static getDerivedStateFromError</a>一起使用</p>
<ul>
<li>参数说明<ul>
<li><code>error</code>: 被抛出的错误。在实现时通常可以替代<code>Error</code></li>
<li><code>info</code>: 包含关于错误的额外的信息的对象；在生产环境，组件名称会最小化；可以通过sorcemap解码获取到常规的javascript stack</li>
</ul>
</li>
<li>用法<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ErrorBoundary</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123; <span class="attr">hasError</span>: <span class="literal">false</span> &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">getDerivedStateFromError</span>(<span class="params">error</span>) &#123;</span><br><span class="line">    <span class="comment">// Update state so the next render will show the fallback UI.</span></span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">hasError</span>: <span class="literal">true</span> &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">componentDidCatch</span>(<span class="params">error, info</span>) &#123;</span><br><span class="line">    <span class="comment">// Example &quot;componentStack&quot;:</span></span><br><span class="line">    <span class="comment">//   in ComponentThatThrows (created by App)</span></span><br><span class="line">    <span class="comment">//   in ErrorBoundary (created by App)</span></span><br><span class="line">    <span class="comment">//   in div (created by App)</span></span><br><span class="line">    <span class="comment">//   in App</span></span><br><span class="line">    <span class="title function_">logErrorToMyService</span>(error, info.<span class="property">componentStack</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">hasError</span>) &#123;</span><br><span class="line">      <span class="comment">// You can render any custom fallback UI</span></span><br><span class="line">      <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">fallback</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">children</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="componentDidMount"><a href="#componentDidMount" class="headerlink" title="componentDidMount()"></a>componentDidMount()</h5><p><code>componentDidMount</code>会在组件添加到屏幕中调用；通常用在获取初始数据、设置订阅或者操作DOM节点。如果使用<code>componentDidMount</code>通常会结合其他生命周期方法一起使用；比如使用<code>componentDidMount</code>读取state和props，同时你需要实现<code>componentDidUpdate</code>去控制它们的变化和使用<code>componentWillUnmount</code>去清除</p>
<ul>
<li>用法<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ChatRoom</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">serverUrl</span>: <span class="string">&#x27;https://localhost:1234&#x27;</span></span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">componentDidMount</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setupConnection</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">componentDidUpdate</span>(<span class="params">prevProps, prevState</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">roomId</span> !== prevProps.<span class="property">roomId</span> ||</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">serverUrl</span> !== prevState.<span class="property">serverUrl</span></span><br><span class="line">    ) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">destroyConnection</span>();</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">setupConnection</span>();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">componentWillUnmount</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">destroyConnection</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="componentDidUpdate-prevProps-prevState-snapshot"><a href="#componentDidUpdate-prevProps-prevState-snapshot" class="headerlink" title="componentDidUpdate(prevProps, prevState, snapshot?)"></a>componentDidUpdate(prevProps, prevState, snapshot?)</h5><p><code>componentDidUpdate</code>会在组件重新渲染的时候调用，该方法不会在初始渲染的时候调用</p>
<ul>
<li>参数说明<ul>
<li><code>prevProps</code>: 更新前的props</li>
<li><code>prevState</code>: 更新前的state</li>
<li><code>snapshot</code>: 如果你实现了<code>getSnapshotBeforeUpdaate</code>方法，<code>snapshot</code>将会包含方法中返回的值，否则返回<code>undefined</code></li>
</ul>
</li>
<li>用法<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ChatRoom</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">serverUrl</span>: <span class="string">&#x27;https://localhost:1234&#x27;</span></span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">componentDidMount</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setupConnection</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">componentDidUpdate</span>(<span class="params">prevProps, prevState</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">roomId</span> !== prevProps.<span class="property">roomId</span> ||</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">serverUrl</span> !== prevState.<span class="property">serverUrl</span></span><br><span class="line">    ) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">destroyConnection</span>();</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">setupConnection</span>();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">componentWillUnmount</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">destroyConnection</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="componentWillUnmount"><a href="#componentWillUnmount" class="headerlink" title="componentWillUnmount()"></a>componentWillUnmount()</h5><p><code>componentWillUnmont</code>会在组件从屏幕中移除前调用</p>
<ul>
<li>用法<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ChatRoom</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    <span class="attr">serverUrl</span>: <span class="string">&#x27;https://localhost:1234&#x27;</span></span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">componentDidMount</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setupConnection</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">componentDidUpdate</span>(<span class="params">prevProps, prevState</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">roomId</span> !== prevProps.<span class="property">roomId</span> ||</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">serverUrl</span> !== prevState.<span class="property">serverUrl</span></span><br><span class="line">    ) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">destroyConnection</span>();</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">setupConnection</span>();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">componentWillUnmount</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">destroyConnection</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="forceUpdate-callback"><a href="#forceUpdate-callback" class="headerlink" title="forceUpdate(callback?)"></a>forceUpdate(callback?)</h5><p>促使组件重新渲染（非state&#x2F;props的外部变量的更新，手动触发）；如果你调用<code>forceUpdate</code>，React将不会调用<code>shouldComponentUpdate</code></p>
<ul>
<li>参数说明<ul>
<li><code>callback</code>: 如果指定了，React会在更新完成后调用这个回调函数</li>
</ul>
</li>
</ul>
<h5 id="getSnapshotBeforeUpdate-prevProps-prevState"><a href="#getSnapshotBeforeUpdate-prevProps-prevState" class="headerlink" title="getSnapshotBeforeUpdate(prevProps, prevState)"></a>getSnapshotBeforeUpdate(prevProps, prevState)</h5><p>如果你实现<code>getSnapshotBeforeUpdate</code>，React在更新DOM之前立即调用该函数；可以通过该函数去捕获DOM的信息，该函数的返回的值当做<code>componentDidUpdate</code>函数的参数</p>
<ul>
<li>参数说明<ul>
<li><code>prevProps</code>: 更新前的props</li>
<li><code>prevState</code>: 更新前的state</li>
<li><code>retutns</code>: 返回任意类型的快照，将会作为<code>componentDidUpdate</code>的第三个参数</li>
</ul>
</li>
<li>用法<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ScrollingList</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">listRef</span> = <span class="title class_">React</span>.<span class="title function_">createRef</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">getSnapshotBeforeUpdate</span>(<span class="params">prevProps, prevState</span>) &#123;</span><br><span class="line">    <span class="comment">// Are we adding new items to the list?</span></span><br><span class="line">    <span class="comment">// Capture the scroll position so we can adjust scroll later.</span></span><br><span class="line">    <span class="keyword">if</span> (prevProps.<span class="property">list</span>.<span class="property">length</span> &lt; <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">list</span>.<span class="property">length</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> list = <span class="variable language_">this</span>.<span class="property">listRef</span>.<span class="property">current</span>;</span><br><span class="line">      <span class="keyword">return</span> list.<span class="property">scrollHeight</span> - list.<span class="property">scrollTop</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">componentDidUpdate</span>(<span class="params">prevProps, prevState, snapshot</span>) &#123;</span><br><span class="line">    <span class="comment">// If we have a snapshot value, we&#x27;ve just added new items.</span></span><br><span class="line">    <span class="comment">// Adjust scroll so these new items don&#x27;t push the old ones out of view.</span></span><br><span class="line">    <span class="comment">// (snapshot here is the value returned from getSnapshotBeforeUpdate)</span></span><br><span class="line">    <span class="keyword">if</span> (snapshot !== <span class="literal">null</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> list = <span class="variable language_">this</span>.<span class="property">listRef</span>.<span class="property">current</span>;</span><br><span class="line">      list.<span class="property">scrollTop</span> = list.<span class="property">scrollHeight</span> - snapshot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">ref</span>=<span class="string">&#123;this.listRef&#125;</span>&gt;</span>&#123;/* ...contents... */&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="render"><a href="#render" class="headerlink" title="render()"></a>render()</h5><h5 id="getDerivedStateFromError"><a href="#getDerivedStateFromError" class="headerlink" title="getDerivedStateFromError"></a>getDerivedStateFromError</h5><h2 id="React-Dom"><a href="#React-Dom" class="headerlink" title="React Dom"></a>React Dom</h2><p><code>react-dom</code>是<code>react</code>主要作用于web application的一个包</p>
<h3 id="Hooks"><a href="#Hooks" class="headerlink" title="Hooks"></a>Hooks</h3><h5 id="useFormStatus"><a href="#useFormStatus" class="headerlink" title="useFormStatus"></a>useFormStatus</h5><p><code>useFormStatus</code>会获取最后一个form提交的状态信息</p>
<ul>
<li>语法<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">const &#123; pending, data, method, action &#125; = useFormStatus();</span><br></pre></td></tr></table></figure></li>
<li>返回值<ul>
<li><code>pending</code>：<code>&lt;form&gt;</code>提交的等待状态</li>
<li><code>data</code>：<code>&lt;form&gt;</code>提交时的数据，如果没有<code>&lt;form&gt;</code>则为<code>null</code></li>
<li><code>method</code>：<code>&lt;form&gt;</code>触发的<code>http</code>请求的方式；<code>get</code>或者<code>post</code></li>
<li><code>action</code>：<code>action</code>中的函数，如果没有<code>&lt;form&gt;</code>或者<code>action</code>是<code>URL</code>或者没有props都返回<code>null</code></li>
</ul>
</li>
</ul>
<h3 id="APIs"><a href="#APIs" class="headerlink" title="APIs"></a>APIs</h3><h5 id="createPortal"><a href="#createPortal" class="headerlink" title="createPortal"></a>createPortal</h5><p><code>createPortal</code>可以将组件渲染在别的DOM下</p>
<ul>
<li>语法</li>
</ul>
<p><code>createPortal(children, domNode, key?)</code></p>
<ul>
<li>参数说明<ul>
<li><code>children</code>：可以被react渲染的任何类型，比如：<code>&lt;div&gt;</code>、<code>&lt;Component/&gt;</code>、<code>&lt;&gt;...&lt;/&gt;</code>、字符串、数字或者数组</li>
<li><code>domNode</code>：已经存在的dom节点，比如通过<code>document.getElementById()</code>获取的dom节点；dom节点更新期间portal也会重新创建</li>
<li><code>key</code>：portal的key</li>
</ul>
</li>
<li>使用场景<ul>
<li>渲染在其他DOM下面</li>
<li>通过portal创建modal dialog</li>
<li>将react组件渲染成服务端标记</li>
<li>将react组件渲染成非react的dom节点</li>
</ul>
</li>
<li>用法<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createPortal &#125; <span class="keyword">from</span> <span class="string">&#x27;react-dom&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">MyComponent</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">border:</span> &#x27;<span class="attr">2px</span> <span class="attr">solid</span> <span class="attr">black</span>&#x27; &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>This child is placed in the parent div.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;createPortal(</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>This child is placed in the document body.<span class="tag">&lt;/<span class="name">p</span>&gt;</span>,</span></span><br><span class="line"><span class="language-xml">        document.body</span></span><br><span class="line"><span class="language-xml">      )&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="flushSync"><a href="#flushSync" class="headerlink" title="flushSync"></a>flushSync</h5><p><code>flushSync</code>可以在回调函数里同步的强制更新React，能确保DOM立即更新</p>
<ul>
<li>语法</li>
</ul>
<p><code>flushSync(callback)</code></p>
<ul>
<li>参数说明<ul>
<li><code>callback</code>：React将会立即调用该回调函数，并且刷新其中更新的内容（pending中的更新、Effect、在Effect中的内容）；如果更新暂停作为<code>flushSync</code>的调用结果，这个后备结果将重新展示</li>
</ul>
</li>
<li>用法<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useState, useEffect &#125; <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; flushSync &#125; <span class="keyword">from</span> <span class="string">&#x27;react-dom&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">PrintApp</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> [isPrinting, setIsPrinting] = <span class="title function_">useState</span>(<span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">handleBeforePrint</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="title function_">flushSync</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">setIsPrinting</span>(<span class="literal">true</span>);</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">handleAfterPrint</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="title function_">setIsPrinting</span>(<span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;beforeprint&#x27;</span>, handleBeforePrint);</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;afterprint&#x27;</span>, handleAfterPrint);</span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">window</span>.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;beforeprint&#x27;</span>, handleBeforePrint);</span><br><span class="line">      <span class="variable language_">window</span>.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;afterprint&#x27;</span>, handleAfterPrint);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, []);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>isPrinting: &#123;isPrinting ? &#x27;yes&#x27; : &#x27;no&#x27;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> window.print()&#125;&gt;</span></span><br><span class="line"><span class="language-xml">        Print</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="createRoot"><a href="#createRoot" class="headerlink" title="createRoot"></a>createRoot</h5><p><code>createRoot</code>创建一个根节点去展示react组件</p>
<ul>
<li>语法</li>
</ul>
<p><code>const root = createRoot(domNode, options?)</code></p>
<ul>
<li>参数说明<ul>
<li><code>comNode</code>：<code>DOM Element</code>，react会创建一个根节点在这个DOM Element下面，并且可以在根节点上执行函数(eg:通过render函数展示react组件)</li>
<li><code>optional</code>：<ul>
<li><code>onRecoverableError</code>：在react自动恢复错误的时候调用的回调，调用的时候会抛出react错误；<code>errorInfo</code>的对象会包含<code>componentStack</code>；有些修复的错误可能会包含原始错误原因在<code>error.cause</code>中</li>
<li><code>identifierPrefix</code>：使用<code>useId</code>生成的字符串前缀；在使用多根节点时候可以避免冲突</li>
<li><code>onCaugthError</code>（Canary only）：在React捕获到错误的时候调用回调</li>
<li><code>onUncaugthError</code>（Canary only）：在抛出错误并且没有被捕获的时候调用回调</li>
</ul>
</li>
<li><code>return</code>：<code>createRoot</code>会返回一个对象，对象包含两个方法<code>render</code>和<code>unmount</code></li>
</ul>
</li>
<li>用法<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createRoot &#125; <span class="keyword">from</span> <span class="string">&quot;react-dom/client&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&quot;./App.js&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;reportRecoverableError&#125; <span class="keyword">from</span> <span class="string">&quot;./reportError&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;./styles.css&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> container = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;root&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> root = <span class="title function_">createRoot</span>(container, &#123;</span><br><span class="line">  <span class="attr">onRecoverableError</span>: <span class="function">(<span class="params">error, errorInfo</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">reportRecoverableError</span>(&#123;</span><br><span class="line">      error,</span><br><span class="line">      <span class="attr">cause</span>: error.<span class="property">cause</span>,</span><br><span class="line">      <span class="attr">componentStack</span>: errorInfo.<span class="property">componentStack</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line">root.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>);</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="hydrateRoot"><a href="#hydrateRoot" class="headerlink" title="hydrateRoot"></a>hydrateRoot</h5><p><code>hydrateRoot</code>能使react组件展示在browser DOM下面；这些html会提前被<code>react-dom/server</code>生成</p>
<ul>
<li>语法</li>
</ul>
<p><code>const root = hydrateRoot(domNode, reactNode, options?)</code></p>
<ul>
<li>参数说明<ul>
<li><code>domNode</code>：将在服务端渲染成根节点的dom元素</li>
<li><code>reactNode</code>：会被渲染在HTML中的react节点（jsx），通过<code>React Server</code>的方法去渲染（eg:renderToPipeableStream(<App />)）</li>
<li><code>optional</code>：同<code>createRoot</code>配置</li>
<li><code>return</code>：<code>createRoot</code>会返回一个对象，对象包含两个方法<code>render</code>和<code>unmount</code></li>
</ul>
</li>
<li>用法<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./styles.css&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; hydrateRoot &#125; <span class="keyword">from</span> <span class="string">&#x27;react-dom/client&#x27;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.js&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_">hydrateRoot</span>(</span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>),</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span></span><br><span class="line">);</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="findDOMNode-Deprecated"><a href="#findDOMNode-Deprecated" class="headerlink" title="findDOMNode(Deprecated)"></a>findDOMNode(Deprecated)</h5><h5 id="render-Deprecated"><a href="#render-Deprecated" class="headerlink" title="render(Deprecated)"></a>render(Deprecated)</h5><p><code>render</code>将React组件挂载到browser dom上（tips：在18版本中已经废弃了，改用createRoot去挂载；17版本之前可用）</p>
<ul>
<li>语法</li>
</ul>
<p><code>render(reactNode, domNode, callback?)</code></p>
<ul>
<li>用法<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./styles.css&#x27;</span>;</span><br><span class="line">  <span class="keyword">import</span> &#123; render &#125; <span class="keyword">from</span> <span class="string">&#x27;react-dom&#x27;</span>;</span><br><span class="line">  <span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.js&#x27;</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>, <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;root&#x27;</span>));</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="Server-APIs"><a href="#Server-APIs" class="headerlink" title="Server APIs"></a>Server APIs</h4><h5 id="renderPipableStream"><a href="#renderPipableStream" class="headerlink" title="renderPipableStream"></a>renderPipableStream</h5><p><code>renderToPipableStream</code>会将react树渲染成可管道化的<code>Node.js Stream</code></p>
<ul>
<li>语法<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; pipe, abort &#125; = <span class="title function_">renderToPipeableStream</span>(reactNode, options?)</span><br></pre></td></tr></table></figure></li>
<li>参数说明<ul>
<li><code>reactNode</code>：你想要渲染在HTML中的react节点；如果希望将他代表完整的documen，组件中的要包含<code>&lt;html&gt;</code>标签</li>
<li><code>optional</code>：包含流配置的一个对象<ul>
<li><code>bootstrapScriptContent</code>：如果指定了，字符串内容将会放在<code>&lt;script&gt;</code>里面</li>
<li><code>bootstrapScript</code>：希望发送到页面上的<code>script</code>url数组，使用它来通过<code>&lt;script&gt;</code>去调用<code>hydrateRoot</code>；如果不希望在客户端中调用React则忽略它</li>
<li><code>bootstrapModules</code>：跟<code>bootstrapScript</code>一样，但是是替换成<code>&lt;script type=&quot;modules&quot;&gt;</code></li>
<li><code>identifierPrefix</code>：字符串前缀，在多根节点的时候能避免冲突；必须于<code>hydrateRoot</code>的前缀相同</li>
<li><code>namespaceURI</code>：流的根<code>namespace URI</code>；默认为常规的HTML；<code>&#39;https://www.w3.org/2000/svg&#39;</code>为SVG、<code>&#39;https://www.w3.org/1998/MathML&#39;</code>为MathML</li>
<li><code>nonce</code>：<code>script-src Content-Security-Policy</code>的字符串</li>
<li><code>onAllReady</code>：在所有的渲染完成后的回调函数，包括外层和额外的内容</li>
<li><code>onShellReady</code>：在初始化外层渲染完成后触发的回调函数；React会将流传输附加的内容沿着行内<code>&lt;script&gt;</code>标签放置的地方去替换掉HTML的备用内容</li>
<li><code>onError</code>：在服务错误的时候触发的回调，无论错误是否被覆盖</li>
<li><code>onShellError</code>：在初始化外层的时候报错的回调，回调函数会接收一个错误参数；并且是在<code>onShellReady</code>和<code>onReady</code>前触发的</li>
<li><code>progressiveChunkSize</code>：一个块的字节数</li>
</ul>
</li>
<li><code>return</code>：返回包含<code>pipe</code>和<code>abort</code>的对象<ul>
<li><code>pipe</code>：将HTML输出到Node.js的可写流的接口中</li>
<li><code>abort</code>：取消服务渲染和停止客户端渲染</li>
</ul>
</li>
</ul>
</li>
<li>用法<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; renderToPipeableStream &#125; <span class="keyword">from</span> <span class="string">&#x27;react-dom/server&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// The route handler syntax depends on your backend framework</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">request, response</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; pipe &#125; = <span class="title function_">renderToPipeableStream</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>, &#123;</span><br><span class="line">    <span class="attr">bootstrapScripts</span>: [<span class="string">&#x27;/main.js&#x27;</span>],</span><br><span class="line">    <span class="title function_">onShellReady</span>(<span class="params"></span>) &#123;</span><br><span class="line">      response.<span class="title function_">setHeader</span>(<span class="string">&#x27;content-type&#x27;</span>, <span class="string">&#x27;text/html&#x27;</span>);</span><br><span class="line">      <span class="title function_">pipe</span>(response);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="renderToReadableStream"><a href="#renderToReadableStream" class="headerlink" title="renderToReadableStream"></a>renderToReadableStream</h5><p><code>renderToReadableStream</code>将React Tree渲染成可读的Web Stream</p>
<ul>
<li>语法<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> stream = <span class="keyword">await</span> <span class="title function_">renderToReadableStream</span>(reactNode, options?)</span><br></pre></td></tr></table></figure></li>
<li>参数说明<ul>
<li><code>reactNode</code>：想要转换成HTML的react 节点</li>
<li><code>optional</code>：<ul>
<li><code>bootstrapScriptContent</code>：该内容将会被置于<code>&lt;script&gt;</code>标签内</li>
<li><code>bootstrapScript</code>：提供给<code>&lt;script&gt;</code>的url数组将发送到页面；使用它包含调用<code>hydrateRoot</code>的方法到<code>&lt;script&gt;</code>标签中；如果不想要在客户端中使用React就忽略它</li>
<li><code>bootstrapModule</code>：与<code>bootstrapScript</code>一样，但是是用的<code>&lt;script type=“module”&gt;</code>代替</li>
<li><code>identifierPrefix</code>：字符串前缀，在多根节点的时候能避免冲突；必须于<code>hydrateRoot</code>的前缀相同</li>
<li><code>namespaceURI</code>：流的根<code>namespace URI</code>；默认为常规的HTML；<code>&#39;https://www.w3.org/2000/svg&#39;</code>为SVG、<code>&#39;https://www.w3.org/1998/MathML&#39;</code>为MathML</li>
<li><code>nonce</code>：<code>script-src Content-Security-Policy</code>的字符串</li>
<li><code>onError</code>：在服务错误的时候触发的回调，无论错误是否被覆盖</li>
<li><code>progressiveChunkSize</code>：一个块的字节数</li>
<li><code>signal</code>：让你取消服务渲染的信号</li>
</ul>
</li>
<li><code>return</code>：将返回一个<code>Promise</code>对象，并且有个额外的<code>allReady</code>属性；当使用<code>allReady</code>时将不会有渲染进程，直接返回最终的HTML</li>
</ul>
</li>
<li>用法<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; renderToReadableStream &#125; <span class="keyword">from</span> <span class="string">&#x27;react-dom/server&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">handler</span>(<span class="params">request</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> stream = <span class="keyword">await</span> <span class="title function_">renderToReadableStream</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>, &#123;</span><br><span class="line">    <span class="attr">bootstrapScripts</span>: [<span class="string">&#x27;/main.js&#x27;</span>]</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Response</span>(stream, &#123;</span><br><span class="line">    <span class="attr">headers</span>: &#123; <span class="string">&#x27;content-type&#x27;</span>: <span class="string">&#x27;text/html&#x27;</span> &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="renderToStaticMarkup"><a href="#renderToStaticMarkup" class="headerlink" title="renderToStaticMarkup"></a>renderToStaticMarkup</h5><p><code>renderToStaticMarkup</code>将没有交互的React tree渲染成HTML字符串</p>
<ul>
<li>语法<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> html = <span class="title function_">renderToStaticMarkup</span>(reactNode, options?)</span><br></pre></td></tr></table></figure></li>
<li>参数说明<ul>
<li><code>reactNode</code>：希望渲染成HTML的React节点</li>
<li><code>options</code>：<ul>
<li><code>identifierPrefix</code>：在多根节点的情况作为身份前缀</li>
</ul>
</li>
</ul>
</li>
<li>用法<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; renderToStaticMarkup &#125; <span class="keyword">from</span> <span class="string">&#x27;react-dom/server&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// The route handler syntax depends on your backend framework</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">request, response</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> html = <span class="title function_">renderToStaticMarkup</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">Page</span> /&gt;</span></span>);</span><br><span class="line">  response.<span class="title function_">send</span>(html);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="renderToStaticNodeStream"><a href="#renderToStaticNodeStream" class="headerlink" title="renderToStaticNodeStream"></a>renderToStaticNodeStream</h5><p><code>renderToStaticNodeStream</code>会将react tree渲染成不可交互的Node.js Stream</p>
<ul>
<li>语法<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> stream = <span class="title function_">renderToStaticNodeStream</span>(reactNode, options?)</span><br></pre></td></tr></table></figure></li>
<li>参数说明<ul>
<li><code>reactNode</code>：希望渲染成HTML的React节点</li>
<li><code>options</code>：<ul>
<li><code>identifierPrefix</code>：在多根节点的情况作为身份前缀</li>
</ul>
</li>
</ul>
</li>
<li>用法<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; renderToStaticNodeStream &#125; <span class="keyword">from</span> <span class="string">&#x27;react-dom/server&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> stream = <span class="title function_">renderToStaticNodeStream</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">Page</span> /&gt;</span></span>);</span><br><span class="line">stream.<span class="title function_">pipe</span>(response);</span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="renderToString"><a href="#renderToString" class="headerlink" title="renderToString"></a>renderToString</h5><p><code>renderToSting</code>会将react节点渲染成HTML字符串</p>
<ul>
<li>语法<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> html = <span class="title function_">renderToString</span>(reactNode, options?)</span><br></pre></td></tr></table></figure></li>
<li>参数说明<ul>
<li><code>reactNode</code>：希望渲染成HTML的React节点</li>
<li><code>options</code>：<ul>
<li><code>identifierPrefix</code>：在多根节点的情况作为身份前缀</li>
</ul>
</li>
</ul>
</li>
<li>用法<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; renderToString &#125; <span class="keyword">from</span> <span class="string">&#x27;react-dom/server&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// The route handler syntax depends on your backend framework</span></span><br><span class="line">app.<span class="title function_">use</span>(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">request, response</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> html = <span class="title function_">renderToString</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">App</span> /&gt;</span></span>);</span><br><span class="line">  response.<span class="title function_">send</span>(html);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="遗留APIs"><a href="#遗留APIs" class="headerlink" title="遗留APIs"></a>遗留APIs</h2><h4 id="Component-1"><a href="#Component-1" class="headerlink" title="Component"></a><a href="#%E5%9F%BA%E7%A1%80%E7%AF%87--component">Component</a></h4>
      </div>
      
      
      
    </div>

    
    


</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">前端那只猪</span>
  </div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/pisces/" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  






  





</body>
</html>
